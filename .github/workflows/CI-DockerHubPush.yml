#name: Java CI with Gradle
#
#on:
#  pull_request:
#    branches: [ main, develop ]
#  push:
#    branches: [ main, develop ]
#
#permissions:
#  contents: read
#
#jobs:
#  build:
#    runs-on: ubuntu-22.04
#    permissions:
#      pull-requests: write
#
#    steps:
#      - name: 레포지토리 체크아웃
#        uses: actions/checkout@v4
#        with:
#          token: ${{ secrets.SUBMODULE_TOKEN }}
#          submodules: true
#
#      - name: JDK 17 설치
#        uses: actions/setup-java@v4
#        with:
#          java-version: '17'
#          distribution: 'temurin'
#
#      - name: gradlew 권한 부여
#        run: chmod +x gradlew
#
#      - name: Gradle 통해 빌드
#        run: ./gradlew clean build
#
#      - name: DockerHub 로그인
#        uses: docker/login-action@v3
#        with:
#          username: ${{ secrets.DOCKERHUB_USERNAME }}
#          password: ${{ secrets.DOCKERHUB_TOKEN }}
#
#      - name: Docker 이미지 이름 설정
#        run: |
#          if [ "${{ github.ref }}" == "refs/heads/main" ]; then
#            echo "IMAGE_NAME=fashion-forecast-prod" >> $GITHUB_ENV
#          else
#            echo "IMAGE_NAME=fashion-forecast-dev" >> $GITHUB_ENV
#          fi
#
#      - name: 도커 빌드 & 푸시
#        uses: docker/build-push-action@v5
#        with:
#          context: .
#          file: ./Dockerfile
#          push: true
#          platforms: linux/amd64
#          tags: ${{ secrets.DOCKERHUB_USERNAME }}/${{ env.IMAGE_NAME }}:latest
